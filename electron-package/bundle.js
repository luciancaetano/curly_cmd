!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TWB=t():e.TWB=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){var o,i;o=[n,t],void 0!==(i=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.translate={en:{ProjectError:"Configuration file error",AreYouSure:"Are You Sure ?",CloseWindowWarn:"By closing this program all processes by tabs will be closed",confirmButtonText:"OK",cancelButtonText:"Cancel",Configurations:"Configurations",ShellCommand:"Shell Command",AskWhenClosingTab:"Always ask when closing a tab ?",CloseToTrayWhenMinimize:"Close to tray when minimize",Cancel:"Cancel",Save:"Save",AboutCurlyCMD:"About CurlyCMD",NewTab:"New Tab",TerminalError:"Terminal Error",TerminalErrorMsg:function(e){return'An error occurred while executing the "'+e+'" command, \n                it may be that the command does not exist or is not valid.'},CloseTabWarn:"By closing this tab all processes by the same will be closed",ChangeTabName:"Change tab name !",SelectLanguage:"Language:",RequiresRestart:"Requires restart",ErrorInvalidFile:'File "curly.cmd.json" is invalid or inaccessible.'},ptBr:{ProjectError:"Erro de arquivo de configuração.",AreYouSure:"Tem certeza ?",CloseWindowWarn:"Ao sair da aplicação todos os processos executados nas abas serão fechados.",confirmButtonText:"OK",cancelButtonText:"Cancelar",Configurations:"Configurações",ShellCommand:"Linha de Comando",AskWhenClosingTab:"Sempre pedir confirmação ao fechar abas ?",CloseToTrayWhenMinimize:"Ocultar tela ao minimizar (Restaurar ao lado do relógio)",Cancel:"Cancelar",Save:"Salvar",AboutCurlyCMD:"Sobre o Curly.CMD",NewTab:"Nova Aba",TerminalError:"Erro de linha de comando",TerminalErrorMsg:function(e){return'Ocorreu um erro ao executar o prompt de comando "'+e+'", \n                Pode ser que este arquivo não exista nas variáveis de ambiente do sistema.'},CloseTabWarn:"Fechar esta aba resultará no término do comando executado na mesma.",ChangeTabName:"Alterar o nome da Aba !",SelectLanguage:"Linguagem:",RequiresRestart:"Requer reinicialização.",ErrorInvalidFile:'O arquivo "curly.cmd.json" é inválido ou inacessível'}}}.apply(t,o))&&(e.exports=i)},function(e,t,n){var o,i;o=[n,t],void 0!==(i=function(e,t){"use strict";function n(e,t,n){void 0===n&&(n=!1);var o=e.split("->");return{event:o.length>0?o[0].trim():null,selector:o.length>1?o[1].trim():null,callback:t,propagate:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.CB=n}.apply(t,o))&&(e.exports=i)},function(e,t,n){var o,i,a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();o=[n,t,n(4),n(3),n(0)],void 0!==(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e_require("sweetalert2"),s=function(e){function t(){var t=e.call(this)||this;return t.tabContainer=$("#cliTabs"),t.consolesContainer=$("#consoles-container"),t.consoles={},t.buildtabs(),t}return a(t,e),t.prototype.addTab=function(e){var t=this;e=e||null;var n="con"+Math.floor(999999*Math.random()+111111),o=this.tabRender(i.translate[this.config.general.lang].NewTab,n).addClass("active");if(e&&e.ctrlKey){var a=e_require("electron").remote,r=a.dialog,s=e_require("path"),l=e_require("os");r.showOpenDialog(a.getCurrentWindow(),{defaultPath:this.config.perfs.lastOpenPath?this.config.perfs.lastOpenPath:a.app.getPath("home"),properties:["openDirectory"]},function(e){if(void 0!==e){var i=e;if("Windows_NT"==l.type()){var a=(e+"").split("\\");i=s.normalize(a.join("/"))}t.config.perfs.lastOpenPath=i,t.storeConfig(),t.createTab(o,n,i,null)}})}else{var c=e_require("electron").remote.getGlobal("args");void 0!==c.cwd&&(c.cwd+"").length>0?this.createTab(o,n,c.cwd,null):this.createTab(o,n,null,null)}},t.prototype.createCWDTab=function(e){var t="con"+Math.floor(999999*Math.random()+111111),n=this.tabRender(i.translate[this.config.general.lang].NewTab,t).addClass("active");this.createTab(n,t,e,null)},t.prototype.createCurlyProjectTab=function(e,t,n){var o="con"+Math.floor(999999*Math.random()+111111),i=this.tabRender(n,o).addClass("active");this.createTab(i,o,e,t)},t.prototype.createTab=function(e,t,o,i){this.tabContainer.append(e),this.consolesContainer.append(this.consoleRender(t)),this.toggleTab(t),this.consoles[t]=new n.Console(t,this.config.general.shellCommand,"New Tab",document.getElementById(t),this.handleDestroyTerminal.bind(this),o,this.config.general.lang,this.config.perfs.lastOpenPath,i)},t.prototype.handleDestroyTerminal=function(e){$("#cliTabs #tab_"+e).remove(),delete this.consoles[e],$("#consoles-container #"+e).remove()},t.prototype.handleCloseTabClick=function(e){var t=this;if(!this.config.general.AlwaysAskWhenClosingTab)return void this.proccessCloseclick(e);r({title:i.translate[this.config.general.lang].AreYouSure,text:i.translate[this.config.general.lang].CloseTabWarn,type:"warning",showCancelButton:!0,confirmButtonText:"OK",allowOutsideClick:!1,reverseButtons:!0}).then(function(){t.proccessCloseclick(e)}).catch(function(){})},t.prototype.proccessCloseclick=function(e){var t=$(e.target),n=t.data("console");this.closeTab(n)},t.prototype.closeTab=function(e){$("#cliTabs #tab_"+e).remove(),this.consoles[e].finalizeTerminal(),delete this.consoles[e],$("#consoles-container #"+e).remove();var t=$("#cliTabs >li:last").data("console");void 0!==t&&(this.toggleTab(t),this.consoles[t].focus())},t.prototype.handleTabClick=function(e){var t=$(e.target);this.toggleTab(t.data("console"));var n=this.consoles[t.data("console")];void 0!==n&&n.focus()},t.prototype.toggleTab=function(e){$("#cliTabs >li").removeClass("active"),$("#consoles-container .terminal-container").hide(),$("#cliTabs >li#tab_"+e).addClass("active"),$("#consoles-container #"+e).show()},t.prototype.changeNameClickHandle=function(e){var t=this,n=$(e.target),o=n.data("console");r({title:i.translate[this.config.general.lang].ChangeTabName,input:"text",showCancelButton:!0,confirmButtonText:"OK",showLoaderOnConfirm:!1,allowOutsideClick:!1,inputValue:"",reverseButtons:!0,preConfirm:function(e){return e+="",new Promise(function(t,n){t(e.trim())})}}).then(function(e){t.changeTabName(o,e)}).catch(function(){})},t.prototype.changeTabName=function(e,t){this.consoles[e].title=t,$("#cliTabs #tab_"+e+" a > span").text(t)},t.prototype.buildtabs=function(){},t.prototype.tabRender=function(e,t){return $('<li id="tab_'+t+'" class="console-tab" data-console="'+t+'">\n            <a href="javascript:;" data-console="'+t+'">\n                <span data-console="'+t+'">'+e+'</span> <i class="glyphicon glyphicon-remove closetab" data-console="'+t+'"></i>\n            </a>\n        </li>')},t.prototype.consoleRender=function(e){return $('<div id="'+e+'" class="terminal-container"></div>')},t}(o.ConfigModal);t.TabsManager=s}.apply(t,o))&&(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0!==(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e_require("electron").remote.app,i=function(){function e(){if(this.config=null,this.tray=null,this.fs=e_require("fs"),this.ini=e_require("ini"),this.os=e_require("os"),this.path=e_require("path"),this.config={general:{AlwaysAskWhenClosingTab:!0,shellCommand:"Windows_NT"==this.os.type()?"cmd.exe":"bash",closeToTrayWhenMinimize:!0,lang:"en"},perfs:{lastOpenPath:""}},this.configFile=this.path.normalize(o.getPath("userData")+"/config.ini"),this.fs.existsSync(this.configFile))try{this.config=this.ini.parse(this.fs.readFileSync(this.configFile,"utf-8"))}catch(e){console.warn(e.message)}else this.storeConfig();this.configDefaults(),console.log("Configuration file : "+this.configFile)}return e.prototype.configDefaults=function(){this.config={general:{AlwaysAskWhenClosingTab:void 0===this.config.general.AlwaysAskWhenClosingTab||this.config.general.AlwaysAskWhenClosingTab,closeToTrayWhenMinimize:void 0===this.config.general.closeToTrayWhenMinimize||this.config.general.closeToTrayWhenMinimize,shellCommand:void 0!==this.config.general.shellCommand?this.config.general.shellCommand:"Windows_NT"==this.os.type()?"cmd.exe":"bash",lang:void 0!==this.config.general.lang?this.config.general.lang:"en"},perfs:this.config.perfs?{lastOpenPath:void 0!==this.config.perfs.lastOpenPath?this.config.perfs.lastOpenPath:void 0}:{lastOpenPath:""}},void 0===n.translate[this.config.general.lang]&&(console.warn("Invalid language setting to default."),this.config.general.lang="en")},e.prototype.storeConfig=function(){var e=this.ini.stringify(this.config);this.fs.writeFileSync(this.configFile,e,"utf-8")},e.prototype.openConfigModal=function(e){$("#configModal").modal({backdrop:!0,keyboard:!1}),$("#configModal [name=shell]").val(this.config.general.shellCommand),$("#configModal [name=askclose]").prop("checked",this.config.general.AlwaysAskWhenClosingTab),$("#configModal [name=askclose]").prop("checked",this.config.general.AlwaysAskWhenClosingTab),$("#configModal [name=minimizeTray]").prop("checked",this.config.general.closeToTrayWhenMinimize),$("#configModal [name=language]").val(this.config.general.lang)},e.prototype.saveConfigModal=function(e){this.config.general.shellCommand=$("#configModal [name=shell]").val(),this.config.general.AlwaysAskWhenClosingTab=$("#configModal [name=askclose]").is(":checked"),this.config.general.closeToTrayWhenMinimize=$("#configModal [name=minimizeTray]").is(":checked"),this.config.general.lang=$("#configModal [name=language]").val(),this.storeConfig(),this.closeConfigModal(),this.doTranslate()},e.prototype.closeConfigModal=function(e){$("#configModal").modal("hide")},e.prototype.doTranslate=function(){var e=this;$("lang").each(function(t,o){var i=$(o).text()+"";i.trim().length>0&&(n.translate[e.config.general.lang]?void 0!==n.translate[e.config.general.lang][i.trim()]&&$(o).text(n.translate[e.config.general.lang][i.trim()]):(console.warn('Invalid language "'+n.translate[e.config.general.lang]+'"'),void 0!==n.translate.en[i.trim()]?o.text(n.translate.en[i.trim()]):console.warn("Invalid language entry "+i.trim())))})},e}();t.ConfigModal=i}.apply(t,o))&&(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0!==(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e_require("xterm"),i=(e_require("os"),e_require("sweetalert2")),a=e_require("node-pty"),r=(e_require("events"),function(){function e(e,t,n,i,a,r,s,l,c){var u=this;this.uid=e,this.title=n,this.bash=t,this.element=i,this.onDestroy=a,this.cwDir=r?r:null,this.lang=s,this.cwd=l,this.commandLine=c,o.loadAddon("fit"),this.createXTerm(),this.createPty(),null!==this.pty&&void 0!==this.pty&&null!==this.terminal&&void 0!==this.terminal&&this.bindTerminals(),this.fit(),setInterval(function(){u.fit()},3e3),this.pty.write(this.commandLine+"\n")}return e.prototype.bindKeys=function(){var e=this;this.terminal.on("keydown",function(t){t.ctrlKey&&78==t.keyCode?window.dispatchEvent(new CustomEvent("handle-shortcuts",{detail:{command:"new-tab",payload:null}})):t.ctrlKey&&84==t.keyCode?window.dispatchEvent(new CustomEvent("handle-shortcuts",{detail:{command:"open-tab",payload:null}})):t.ctrlKey&&87==t.keyCode&&window.dispatchEvent(new CustomEvent("handle-shortcuts",{detail:{command:"close-tab",payload:e.uid}}))})},e.prototype.createXTerm=function(){this.terminal=new o({cursorBlink:!0,name:"xterm-256color",debug:!0}),this.terminal.open(this.element)},e.prototype.createPty=function(){try{var e=e_require("electron").remote.app;this.cwd;this.pty=a.fork(this.bash,[],{name:"xterm-256color",cwd:null!==this.cwDir?this.cwDir:e_require("path").normalize(e.getPath("home"))})}catch(e){this.pty=null,this.terminal.destroy(),i({title:n.translate[this.lang].TerminalError,text:n.translate[this.lang].TerminalErrorMsg(this.bash),type:"error"}).then(function(){}).catch(function(){}),console.warn(e.message)}},e.prototype.bindTerminals=function(){var e=this;this.terminal.on("data",function(t){void 0!==e.pty&&null!==e.pty&&e.pty.write(t)}),this.pty.on("data",function(t){void 0!==e.terminal&&null!==e.terminal&&e.terminal.write(t)}),this.pty.on("exit",function(t){e.onDestroy(e.uid),e.terminal.destroy()}),this.terminal.on("exit",function(t){e.pty.destroy()}),this.terminal.on("resize",function(t){void 0!==e.pty&&null!==e.pty&&e.pty.resize(t.cols,t.rows)}),window.addEventListener("resize",function(t){e.fit()})},e.prototype.focus=function(){void 0!==this.terminal&&null!==this.terminal&&this.terminal.focus()},e.prototype.fit=function(){void 0!==this.terminal&&null!==this.terminal&&this.terminal.fit()},e.prototype.hide=function(){$(this.element).hide()},e.prototype.show=function(){$(this.element).show()},e.prototype.finalizeTerminal=function(e){e=e||0,void 0!==this.terminal&&null!==this.terminal&&this.terminal.destroy(),void 0!==this.pty&&null!==this.pty&&this.pty.destroy()},e}());t.Console=r}.apply(t,o))&&(e.exports=i)},function(e,t,n){var o,i,a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();o=[n,t,n(1),n(2),n(0)],void 0!==(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),e_require("./assets/js/bootstrap.min.js"),e_require("./assets/js/jquery.scrolling-tabs.min.js");var r=e_require("sweetalert2"),s=e_require("electron").remote,l=function(e){function t(){var t=e.call(this)||this;t.bindings=[n.CB("click -> #add-tab",t.addTab),n.CB("click -> #closeConfigModal",t.closeConfigModal),n.CB("click -> #saveConfigModal",t.saveConfigModal),n.CB("click -> #openConfigModal",t.openConfigModal),n.CB("click -> #openAbout",t.openAboutWindow),n.CB("click -> #closeAboutDialog",t.closeAboutWindow),n.CB("click -> #cliTabs > li i.closetab",t.handleCloseTabClick),n.CB("click -> #cliTabs > li",t.handleTabClick),n.CB("dblclick -> #cliTabs > li",t.changeNameClickHandle),n.CB("click -> .minimize-button",t.minimizeWindow),n.CB("click -> .maximize-button",t.maximizeWindow),n.CB("click -> .unmaximize-button",t.unMaximizeWindow),n.CB("click -> .close-button",t.closeWindow)];var o=e_require("electron").remote.getGlobal("args"),i=e_require("path"),a=e_require("fs");if(void 0!==o.cwd)if((o.cwd+"").length>0){var r=i.normalize(o.cwd+"/curly.cmd.json");a.existsSync(r)?t.loadProject(o.cwd,r):t.createCWDTab(o.cwd)}else t.addTab();else t.addTab();return t.bind(),t.bindShortcuts(),t.bindWindowEvents(),t.doTranslate(),t}return a(t,e),t.prototype.loadProject=function(e,t){var n=this,o=e_require("fs");try{var a=o.readFileSync(t,"utf-8");JSON.parse(a).forEach(function(t){void 0!==t.name&&t.command?n.createCurlyProjectTab(e,t.command,t.name):r({title:i.translate[n.config.general.lang].ProjectError,text:i.translate[n.config.general.lang].ErrorInvalidFile,type:"error"}).then(function(){}).catch(function(){})})}catch(e){r({title:i.translate[this.config.general.lang].ProjectError,text:i.translate[this.config.general.lang].ErrorInvalidFile,type:"error"}).then(function(){}).catch(function(){})}},t.prototype.openAboutWindow=function(){var e=e_require("electron").remote;e_require("path"),e_require("url");$("#appName").text("Curly CMD"),$("#appVersion").text(e.app.getVersion()),$("#electronVersion span").text(e.process.versions.electron),$("#nodeVersion span").text(e.process.versions.node),$("#chromeVersion span").text(e.process.versions.chrome),$(".about-window").fadeIn("fast")},t.prototype.closeAboutWindow=function(){$(".about-window").fadeOut("fast")},t.prototype.bind=function(){var e=this;this.bindings.forEach(function(t){null!==t.event&&null!==t.event?$("body").on(t.event,t.selector,function(n){n&&n.preventDefault(),t.propagate||n&&n.stopPropagation(),t.callback.bind(e)(n)}):console.warn("Bind "+t+" failed.")}),this.initializeTray()},t.prototype.bindShortcuts=function(){var e=this;window.addEventListener("handle-shortcuts",function(t){switch(t.detail.command){case"new-tab":e.addTab();break;case"open-tab":e.addTab({ctrlKey:!0});break;case"close-tab":e.closeTab(t.detail.payload);break;case"hide-win":e_require("electron").remote.getCurrentWindow().hide()}})},t.prototype.initializeTray=function(){var e=this,t=e_require("electron").remote,n=t.getCurrentWindow(),o=t.Tray,i=t.Menu,a=(t.nativeImage,e_require("path")),r=a.join(a.dirname(e_require.main.filename),"appicon.ico");this.tray=new o(r),this.tray.setToolTip("CurlyCMD terminal emulator");n.on("minimize",function(t){e.config.general.closeToTrayWhenMinimize&&(t.preventDefault(),n.hide())});var s=i.buildFromTemplate([{label:"Quit",click:function(){n.show(),e.tryQuitApp()}},{label:"Restore",click:function(){return n.show()}}]);this.tray.setContextMenu(s),this.tray.on("double-click",function(){return n.show()})},t.prototype.tryQuitApp=function(){r({title:i.translate[this.config.general.lang].AreYouSure,text:i.translate[this.config.general.lang].CloseWindowWarn,type:"warning",showCancelButton:!0,confirmButtonText:"OK",cancelButtonText:"OK",allowOutsideClick:!1,reverseButtons:!0}).then(function(){s.app.exit(0)}).catch(function(){})},t.prototype.minimizeWindow=function(){e_require("electron").remote.getCurrentWindow().minimize()},t.prototype.maximizeWindow=function(){e_require("electron").remote.getCurrentWindow().maximize()},t.prototype.unMaximizeWindow=function(){e_require("electron").remote.getCurrentWindow().unmaximize()},t.prototype.closeWindow=function(){this.tryQuitApp()},t.prototype.bindWindowEvents=function(){var e=this,t=e_require("electron").remote.getCurrentWindow();t.isMaximized()?($(".unmaximize-button").show(),$(".maximize-button").hide()):($(".unmaximize-button").hide(),$(".maximize-button").show()),t.on("maximize",function(){$(".unmaximize-button").show(),$(".maximize-button").hide()}),t.on("unmaximize",function(){$(".unmaximize-button").hide(),$(".maximize-button").show()}),window.onbeforeunload=function(t){return t.returnValue=!1,e.tryQuitApp(),!1}},t}(o.TabsManager);$(function(){window.app=new l})}.apply(t,o))&&(e.exports=i)}])});